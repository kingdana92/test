<div class="config-inputs" style="display: none;"> <input type="text" id="api-key" value="{{ API }}">
    <input type="text" id="endpoint-url" value="{{ ENDPOINT }}">
</div>

<script>
    document.getElementById('place-order-button').addEventListener('click', () => {
        const apiKey = document.getElementById('api-key').value;
        const endpoint = document.getElementById('endpoint-url').value;
        const amountValue = parseInt(document.getElementById('amount-input').value);

        const btn = document.getElementById('place-order-button');
        btn.innerText = "Processing...";
        btn.disabled = true;

        const MMPayApp = new MMPaySDK(apiKey, {
            baseUrl: endpoint, 
            environment: 'pay',
            merchantName: 'AyeParKwar', 
        });

        MMPayApp.showPaymentModal({
            amount: amountValue,
            orderId: 'APK-' + new Date().getTime(),
            // We point this to our Python Server's callback endpoint
            callbackUrl: window.location.origin + '/payment-callback' 
        }, (result) => {
            // This is just the UI response
            if (result.success) {
                window.location.href = '/success';
            } else {
                btn.innerText = "Pay Securely";
                btn.disabled = false;
                alert("Payment failed or cancelled.");
            }
        });
    });
</script>